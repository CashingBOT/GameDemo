{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\PlayerBulletsEmitter2.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn TypeScript:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class PlayerBulletsEmitter2 extends cc.Component {\r\n\r\n    @property(cc.Prefab)\r\n    prefab: cc.Prefab = null;\r\n\r\n    @property()\r\n    speed = 1000;\r\n\r\n    @property()\r\n    offset = 0;\r\n\r\n    private _emitSeq = 0;\r\n    private _keyDown = false;\r\n    private emit = false;\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {}\r\n\r\n    start() {\r\n        cc.director.getCollisionManager().enabled = true;\r\n    }\r\n\r\n    onEnable() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    onDisable() {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    public emitOff() {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    public emitOn() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    update(dt) {\r\n        //console.log(this._emitSeq);\r\n        if (this._emitSeq > 0.2) {\r\n            this._emitSeq = 0;\r\n            if (this.emit) {\r\n                this.emitter();\r\n            }\r\n        }\r\n        this._emitSeq = this._emitSeq + dt;\r\n    }\r\n\r\n    public emitter() {\r\n        var bullet = cc.instantiate(this.prefab);\r\n        bullet.position = this.node.position;\r\n        bullet.x += this.offset;\r\n        bullet.y = this.node.y + 5;\r\n        bullet.parent = this.node.parent;\r\n        let distance = cc.winSize.height - bullet.y - 10\r\n        let duration = (distance / this.speed) / 2;\r\n        let moveBy = cc.moveTo(duration, cc.v2(bullet.x, 490));\r\n        let reMoveSelf = cc.removeSelf();\r\n        let sequence = cc.sequence(moveBy, reMoveSelf, cc.callFunc(() => { bullet.active = false }));\r\n        bullet.runAction(sequence);\r\n    }\r\n\r\n    public onKeyDown(event) {\r\n        // set a flag when key pressed\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.j:\r\n                this.emit = true;\r\n                if (!this._keyDown) {\r\n                    this._keyDown = true;\r\n                    this._emitSeq = 0;\r\n                    this.emitter();\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    public onKeyUp(event) {\r\n        // set a flag when key pressed\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.j:\r\n                this.emit = false;\r\n                this._keyDown = false;\r\n                break;\r\n        }\r\n    }\r\n}\r\n"]}