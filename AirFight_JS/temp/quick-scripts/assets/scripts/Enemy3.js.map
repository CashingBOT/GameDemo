{"version":3,"sources":["Enemy3.js"],"names":["cc","Class","extends","Component","properties","speed","life","ctor","isDead","type","onLoad","unuse","node","stopAllActions","reuse","loader","loadRes","SpriteFrame","err","res","console","log","getComponent","Sprite","spriteFrame","start","update","dt","dead","noEvent","explode","event","Event","EventCustom","setUserData","dispatchEvent","parent","gainScoreEnemy2","fun","urls","loadResArray","runAction","sequence","callFunc","delayTime","emitter","enemy","position","y","distance","winSize","height","duration","moveBy","v2","callBack","seq","onCollisionStay","other","self","name","active"],"mappings":"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","file":"Enemy3.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        speed: 100,\r\n        life: 5,\r\n    },\r\n\r\n    ctor() {\r\n        this.isDead = false;\r\n        this.type = 3;\r\n        \r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n    \r\n    },\r\n\r\n    unuse() {\r\n        this.node.stopAllActions()\r\n    },\r\n\r\n    reuse() {\r\n        this.life = 5\r\n        this.isDead = false\r\n        cc.loader.loadRes('飞机4a', cc.SpriteFrame, (err, res) => {\r\n            if (err) {\r\n                console.log('error');\r\n                return;\r\n            }\r\n            this.getComponent(cc.Sprite).spriteFrame = res\r\n        })\r\n    },\r\n\r\n    start() {\r\n       \r\n    },\r\n\r\n    update(dt) {\r\n        if (this.life <= 0 && !this.isDead) {\r\n            this.dead()\r\n        }\r\n    },\r\n\r\n    dead(noEvent) {\r\n        if (!this.isDead) {\r\n            this.explode(()=>{\r\n                if (!noEvent) {\r\n                    \r\n                    let event = new cc.Event.EventCustom('enemyDestory', true)\r\n                    event.setUserData(this)\r\n                    this.node.dispatchEvent(event)\r\n                }\r\n            });\r\n            this.node.parent.getComponent('Game').gainScoreEnemy2();\r\n            this.isDead = true;\r\n        }\r\n    },\r\n\r\n    explode(fun) {\r\n        var urls = ['飞机4a爆炸1', '飞机4a爆炸2', '飞机4a爆炸3', '飞机4a爆炸4']\r\n        cc.loader.loadResArray(urls, cc.SpriteFrame, (err, res) => {\r\n            if (err) {\r\n                console.log('error');\r\n                return;\r\n            }\r\n            this.node.runAction(cc.sequence(cc.callFunc(() => {\r\n                this.getComponent(cc.Sprite).spriteFrame = res[0]\r\n            }), cc.delayTime(0.075), cc.callFunc(() => {\r\n                this.getComponent(cc.Sprite).spriteFrame = res[1]\r\n            }), cc.delayTime(0.075), cc.callFunc(() => {\r\n                this.getComponent(cc.Sprite).spriteFrame = res[2]\r\n            }), cc.delayTime(0.075), cc.callFunc(() => {\r\n                this.getComponent(cc.Sprite).spriteFrame = res[3]\r\n            }), cc.delayTime(0), cc.callFunc(() => {\r\n                fun()\r\n            })))\r\n        })\r\n    },\r\n\r\n    emitter: function () {\r\n        var enemy = this.node;\r\n        enemy.position = this.node.position;\r\n        enemy.y = this.node.y;\r\n        enemy.parent = this.node.parent;\r\n        let distance = (cc.winSize.height + this.node.y);\r\n        let duration = distance / this.speed;\r\n        let moveBy = cc.moveBy(duration, cc.v2(0, -distance));\r\n        let callBack = cc.callFunc(() => {\r\n            let event = new cc.Event.EventCustom('enemyDestory', true)\r\n            event.setUserData(this)\r\n            this.node.dispatchEvent(event)\r\n        }, this);\r\n        // let sequence = cc.sequence(moveBy, reMoveSelf);\r\n        let seq = cc.sequence(moveBy, callBack)\r\n        enemy.runAction(seq);\r\n    },\r\n\r\n    onCollisionStay: function (other, self) {\r\n        this.life--;\r\n        if (other.node.name == \"PlayerBullets\") {\r\n            other.node.active = false;\r\n        }\r\n        //console.log('on collision enter');\r\n        //console.log('Enemy1Life: ' + this.life);\r\n    },\r\n})\r\n"]}