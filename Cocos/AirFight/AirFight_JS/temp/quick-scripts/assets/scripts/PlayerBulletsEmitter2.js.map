{"version":3,"sources":["PlayerBulletsEmitter2.js"],"names":["cc","Class","extends","Component","properties","prefab","Prefab","speed","offset","ctor","_emitSeq","_keyDown","emit","start","director","getCollisionManager","enabled","onEnable","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDisable","off","update","dt","emitter","bullet","instantiate","position","node","x","y","parent","distance","winSize","height","duration","moveBy","v2","reMoveSelf","removeSelf","sequence","runAction","event","keyCode","macro","KEY","j"],"mappings":"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","file":"PlayerBulletsEmitter2.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        prefab: cc.Prefab,\r\n        speed: 1000,\r\n        offset: 0,\r\n    },\r\n\r\n    ctor() {\r\n        this._emitSeq = 0;\r\n        this._keyDown = false;\r\n        this.emit = false;\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    // onLoad () {},\r\n\r\n    start() {\r\n        cc.director.getCollisionManager().enabled = true;\r\n    },\r\n\r\n    onEnable() {\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    },\r\n\r\n    onDisable() {\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this);\r\n    },\r\n\r\n    update(dt){\r\n        //console.log(this._emitSeq);\r\n        if (this._emitSeq > 0.2)\r\n        {\r\n            this._emitSeq = 0;\r\n            if(this.emit){\r\n                this.emitter();\r\n            }\r\n        }\r\n        this._emitSeq = this._emitSeq + dt;\r\n    },\r\n\r\n    emitter: function(){\r\n        var bullet = cc.instantiate(this.prefab);\r\n        bullet.position = this.node.position;\r\n        bullet.x += this.offset;\r\n        bullet.y = this.node.y + 30;\r\n        bullet.parent = this.node.parent;\r\n        let distance = cc.winSize.height - bullet.y\r\n        let duration = distance / this.speed;\r\n        let moveBy = cc.moveBy(duration,cc.v2(0,distance));\r\n        let reMoveSelf = cc.removeSelf();\r\n        let sequence = cc.sequence(moveBy,reMoveSelf);\r\n        bullet.runAction(sequence);\r\n    },\r\n\r\n    onKeyDown(event) {\r\n        // set a flag when key pressed\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.j:\r\n                this.emit = true;\r\n                if(!this._keyDown) {\r\n                    this._keyDown = true;\r\n                    this._emitSeq = 0;\r\n                    this.emitter();\r\n                }\r\n                break;\r\n        }\r\n    },\r\n\r\n    onKeyUp(event) {\r\n        // set a flag when key pressed\r\n        switch (event.keyCode) {\r\n            case cc.macro.KEY.j:\r\n                this.emit = false;\r\n                this._keyDown = false;\r\n                break;\r\n        }\r\n    },\r\n})\r\n"]}